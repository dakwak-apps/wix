<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Settings Endpoint</title>
    <script type="text/javascript" src="//sslstatic.wix.com/services/js-sdk/1.16.0/js/Wix.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script>
    <script src="js/happy.js" type="text/javascript"></script>
    <script src="js/happy.methods.js" type="text/javascript"></script>

    <link href="css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css" />
    <script type="text/javascript">

        jQuery(document).ready(function () {

            Wix.currentMember(function(memberDetails){
               alert(memberDetails.toSource());
            })


            jQuery('#settings-form').isHappy({
                fields: {
                    // reference the field you're talking about, probably by `id`
                    // but you could certainly do $('[name=name]') as well.
                    '#url': {
                        required: true,
                        message: 'We need your website URL.',
                        unHappy: jQuery('#url').addClass('has-error')
                    },
                    '#email': {
                        required: true,
                        message: 'Make sure you type your email correctly.',
                        test: happy.email,  // this can be *any* function that returns true or false
                        unHappy: function() {jQuery('#email').addClass('has-error');}
                    }
                }
            });

            jQuery('#settings-form').submit(function() {
                var email = jQuery('#email').val();
                var url = jQuery('#url').val();
                var from_lang = jQuery('#original_language').val();
                var to_lang = jQuery('#target_language').val();

                jQuery.ajax
                ({

                    type: "POST",
                    //the url where you want to sent the userName and password to
                    //url: 'https://dakwak.com/api/users/new.json',
                    url: 'http://localhost/wix/api.php',
                    dataType: 'json',
                    data: {compId: Wix.Utils.getOrigCompId()},
                    //data: {email: email, url: url, from_lang: from_lang, to_lang: to_lang},
                    success: function (data) {
                        alert(data.toSource());
                        if(typeof (data.username) != 'undefined' && typeof (data.apikey) != 'undefined') {
                            var compId = Wix.Utils.getOrigCompId();
                                alert(compId);
                        }
                    },

                    error: function(error, b, c) {
                       alert(error);
                    }
                });

                return false;
            });
        });

    </script>

    <style>
        .unhappyMessage {
          float: right;
          color: #B94A48;
        }
    </style>
</head>
<body>
<img src="images/logo.png" class="img-thumbnail" style="margin: 5px"/>
<h4>Dakwak Settings</h4>
<form id="settings-form" action="" >

        <div class="form-group">
            <label>E-mail:</label>
            <input class="form-control" id="email" type="text" name="email" />
       </div>
       <div class="form-group">
            <label>Website URL:</label>
            <input class="form-control" id="url" type="text" name="url" />
       </div>
        <div class="form-group">
            <label>Original language:</label>
            <select class="form-control" id="original_language" name="original_language">
                <option value="af">Afrikaans</option><option value="el">Greek</option><option value="ro">Romanian</option><option value="sq">Albanian</option><option value="iw">Hebrew</option><option value="ru">Russian</option><option value="ar">Arabic</option><option value="hi">Hindi</option><option value="sr">Serbian</option><option value="be">Belarusian</option><option value="hu">Hungarian</option><option value="sk">Slovak</option><option value="bg">Bulgarian</option><option value="is">Icelandic</option><option value="sl">Slovenian</option><option value="ca">Catalan</option><option value="id">Indonesian</option><option value="es">Spanish</option><option value="zh-CN">Chinese (Simplified)</option><option value="ga">Irish</option><option value="sw">Swahili</option><option value="hr">Croatian</option><option value="it">Italian</option><option value="sv">Swedish</option><option value="cs">Czech</option><option value="ja">Japanese</option><option value="th">Thai</option><option value="da">Danish</option><option value="ko">Korean</option><option value="tr">Turkish</option><option value="nl">Dutch</option><option value="lv">Latvian</option><option value="uk">Ukrainian</option><option value="en">English</option><option value="lt">Lithuanian</option><option value="vi">Vietnamese</option><option value="et">Estonian</option><option value="mk">Macedonian</option><option value="cy">Welsh</option><option value="tl">Filipino</option><option value="ms">Malay</option><option value="yi">Yiddish</option><option value="fi">Finnish</option><option value="mt">Maltese</option><option value="ur">Urdu</option><option value="fr">French</option><option value="fa">Persian</option><option value="zh-TW">Chinese (Traditional)</option><option value="gl">Galician</option><option value="pl">Polish</option><option value="fr-CA">French (Canada)</option><option value="de">German</option><option value="pt-PT">Portuguese (Europe)</option><option value="es-LA">Spanish (Latin America)</option><option value="pt-BR">Portuguese (Brazil)</option>
            </select>
        </div>
        <div class="form-group">
            <label>Target language:</label>
            <select class="form-control"  id="target_language" name="target_language">
                <option value="af">Afrikaans</option><option value="el">Greek</option><option value="ro">Romanian</option><option value="sq">Albanian</option><option value="iw">Hebrew</option><option value="ru">Russian</option><option value="ar">Arabic</option><option value="hi">Hindi</option><option value="sr">Serbian</option><option value="be">Belarusian</option><option value="hu">Hungarian</option><option value="sk">Slovak</option><option value="bg">Bulgarian</option><option value="is">Icelandic</option><option value="sl">Slovenian</option><option value="ca">Catalan</option><option value="id">Indonesian</option><option value="es">Spanish</option><option value="zh-CN">Chinese (Simplified)</option><option value="ga">Irish</option><option value="sw">Swahili</option><option value="hr">Croatian</option><option value="it">Italian</option><option value="sv">Swedish</option><option value="cs">Czech</option><option value="ja">Japanese</option><option value="th">Thai</option><option value="da">Danish</option><option value="ko">Korean</option><option value="tr">Turkish</option><option value="nl">Dutch</option><option value="lv">Latvian</option><option value="uk">Ukrainian</option><option value="en">English</option><option value="lt">Lithuanian</option><option value="vi">Vietnamese</option><option value="et">Estonian</option><option value="mk">Macedonian</option><option value="cy">Welsh</option><option value="tl">Filipino</option><option value="ms">Malay</option><option value="yi">Yiddish</option><option value="fi">Finnish</option><option value="mt">Maltese</option><option value="ur">Urdu</option><option value="fr">French</option><option value="fa">Persian</option><option value="zh-TW">Chinese (Traditional)</option><option value="gl">Galician</option><option value="pl">Polish</option><option value="fr-CA">French (Canada)</option><option value="de">German</option><option value="pt-PT">Portuguese (Europe)</option><option value="es-LA">Spanish (Latin America)</option><option value="pt-BR">Portuguese (Brazil)</option>
            </select>
        </div>
        <div class="form-group">
            <input type="submit" name="submit" value="Save settings" class="btn btn-default btn-success">
        </div>

</form>
</body>
</html>